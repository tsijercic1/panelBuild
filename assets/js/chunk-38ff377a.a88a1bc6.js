(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38ff377a"],{2745:function(e,t,n){},5514:function(e,t,n){},"5e25":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-overlay",{attrs:{value:e.showOverlay}},[n("v-card",{ref:"overlayChildRef",attrs:{id:"overlayChildId"}})],1),n("h1",[e._v("Assignments")]),n("div",[n("vue-context",{ref:"menu",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return[null!==r&&void 0!==r?[n("li",[e.assignmentEligible(r)?n("a",{on:{click:function(t){return t.preventDefault(),e.onClick("Create assignment",r)}}},[e._v(" Create assignment ")]):e._e(),e.fileEligible(r)?n("a",{on:{click:function(t){return t.preventDefault(),e.onClick("Create file",r)}}},[e._v(" Create file ")]):e._e()]),n("li",[r.isDirectory?n("a",{on:{click:function(t){return t.preventDefault(),e.onClick("Edit assignment",r)}}},[e._v(" Edit assignment ")]):n("a",{on:{click:function(t){return t.preventDefault(),e.onClick("Edit file",r)}}},[e._v(" Edit file ")])]),n("li",[r.isDirectory?n("a",{on:{click:function(t){return t.preventDefault(),e.onClick("Delete assignment",r)}}},[e._v(" Delete assignment ")]):n("a",{on:{click:function(t){return t.preventDefault(),e.onClick("Delete file",r)}}},[e._v(" Delete file ")])])]:e._e()]}}])})],1),n("v-container",{attrs:{fluid:""}},[n("v-row",[n("v-col",{attrs:{md:"3"}},[n("v-treeview",{attrs:{activatable:"",dense:"",hoverable:"",items:e.assignments,"return-object":"",active:e.active},on:{"update:active":[function(t){e.active=t},function(t){return e.activeChanged(e.active)}]},scopedSlots:e._u([{key:"prepend",fn:function(t){var r=t.item,a=t.open;return[r.isDirectory?n("v-icon",{on:{contextmenu:function(t){return t.preventDefault(),e.$refs.menu.open(t,r)}}},[e._v(" "+e._s(a?"mdi-folder-open":"mdi-folder")+" ")]):n("v-icon",{on:{contextmenu:function(t){return t.preventDefault(),e.$refs.menu.open(t,r)}}},[e._v(" "+e._s(e.fileTypes[e.extensionRegex.exec(r.name)[1]])+" ")])]}},{key:"label",fn:function(t){var r=t.item;return[n("v-list-item-title",{on:{contextmenu:function(t){return t.preventDefault(),e.$refs.menu.open(t,r)}}},[e._v(" "+e._s(r.name)+" ")])]}}])})],1),n("v-col",{attrs:{cols:"9"}},[n("v-card",{staticClass:"sticky",attrs:{tile:"",elevation:"2"}},[n("FileEditor",{ref:"fileEditor",staticClass:"editorWrapper",attrs:{course:e.course}})],1)],1)],1)],1)],1)},a=[],i=(n("4160"),n("b0c0"),n("ac1f"),n("159b"),n("96cf"),n("1da1")),s=n("b85c"),c=n("5530"),o=(n("2791"),n("f513"),n("fe5f"),n("4ba6"),n("f9d4"),n("b866"),n("7ba3"),n("5514"),n("10b2"),n("2f62")),u=n("899b"),l=(n("f89b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100%"}},["none"===e.editable.type?n("v-card",{staticClass:"inner-tile",attrs:{tile:""}},[n("v-card-title",[e._v("Select a file")])],1):"html"===e.editable.type?n("v-card",{staticClass:"inner-tile",attrs:{tile:""}},[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.file.name))]),n("v-spacer"),n("v-checkbox",{attrs:{label:"Binary"},model:{value:e.binary,callback:function(t){e.binary=t},expression:"binary"}}),n("v-spacer"),n("v-checkbox",{attrs:{label:"Show"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}}),n("v-spacer"),n("v-btn",{on:{click:function(t){return e.save()}}},[e._v("Save")])],1),n("div",[n("editor",{ref:"toaster",attrs:{options:e.editorOptions,height:"75vh"}})],1)],1):e.rawEditorFileExtensions.includes(e.editable.type)?n("v-card",{attrs:{tile:""}},[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.file.name))]),n("v-spacer"),n("v-checkbox",{attrs:{label:"Binary"},model:{value:e.binary,callback:function(t){e.binary=t},expression:"binary"}}),n("v-spacer"),n("v-checkbox",{attrs:{label:"Show"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}}),n("v-spacer"),n("v-btn",{attrs:{disabled:e.isSaving},on:{click:function(t){return e.save()}}},[e._v("Save")])],1),n("div",[n("codemirror",{ref:"mirror",attrs:{options:e.cmOptions,id:"codemirror"},model:{value:e.fileContent,callback:function(t){e.fileContent=t},expression:"fileContent"}})],1)],1):e._e()],1)}),d=[],p=(n("99af"),n("caad"),n("8f94")),m=n("4ede"),f=(n("d3b7"),{getAssignments:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a,i,s,c,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.id,a=e.external,i=e.year,s=e.name,n.next=3,fetch("/services/assignments.php?action=getAssignments&course_id=".concat(r).concat(a?"&X":"","&year=").concat(i),{method:"get",headers:{Accept:"application/json"}});case 3:return c=n.sent,n.next=6,c.json();case 6:return o=n.sent,o.success||t({type:"bad",group:"main",title:"Getting assignments for ".concat(s),text:"".concat(o.message||"An error has occurred.")}),n.abrupt("return",o.data);case 9:case"end":return n.stop()}}),n)})))()},convertAssignments:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a,i,s,c,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.id,a=e.external,i=e.year,s=e.name,n.next=3,fetch("/services/assignments.php?action=updateAssignments&course_id=".concat(r).concat(a?"&X":"","&year=").concat(i),{method:"get",headers:{Accept:"application/json"}});case 3:return c=n.sent,n.next=6,c.json();case 6:return o=n.sent,o.success||t({type:"bad",group:"main",title:"Converting assignments for ".concat(s),text:"".concat(o.message||"An error has occurred.")}),n.abrupt("return",o);case 9:case"end":return n.stop()}}),n)})))()},createAssignment:function(e,t,n){return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,o,u,l,d,p,m,f,h,v;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.id,i=e.external,s=e.year,c=e.name,o=t.path,u=t.name,l=t.displayName,d=t.type,p=t.hidden,m=t.homeworkId,f="/services/assignments.php?action=createAssignment&course_id=".concat(a).concat(i?"&X":"","&year=").concat(s),r.next=5,fetch(f,{method:"post",headers:{Accept:"application/json"},body:JSON.stringify({path:o,name:u,displayName:l,type:d,hidden:p,homeworkId:m})});case 5:return h=r.sent,r.next=8,h.json();case 8:return v=r.sent,!v.success&&n&&n({type:"bad",group:"main",title:"Creating assignment for ".concat(c),text:"".concat(v.message||"An error has occurred.")}),r.abrupt("return",v);case 11:case"end":return r.stop()}}),r)})))()},editAssignment:function(e,t,n){return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,o,u,l,d,p,m,f,h;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.id,i=e.external,s=e.year,c=e.name,o=t.path,u=t.displayName,l=t.type,d=t.hidden,p=t.homeworkId,m="/services/assignments.php?action=editAssignment&course_id=".concat(a).concat(i?"&X":"","&year=").concat(s),r.next=5,fetch(m,{method:"post",headers:{Accept:"application/json"},body:JSON.stringify({path:o,displayName:u,type:l,hidden:d,homeworkId:p})});case 5:return f=r.sent,r.next=8,f.json();case 8:return h=r.sent,!h.success&&n&&n({type:"bad",group:"main",title:"Editing assignment for ".concat(c),text:"".concat(h.message||"An error has occurred.")}),r.abrupt("return",h);case 11:case"end":return r.stop()}}),r)})))()},deleteAssignment:function(e,t,n){return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,o,u,l,d;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.id,i=e.external,s=e.year,c=e.name,o=t.path,u="/services/assignments.php?action=deleteAssignment&course_id=".concat(a).concat(i?"&X":"","&year=").concat(s),r.next=5,fetch(u,{method:"post",headers:{Accept:"application/json"},body:JSON.stringify({path:o})});case 5:return l=r.sent,r.next=8,l.json();case 8:return d=r.sent,!d.success&&n&&n({type:"bad",group:"main",title:"Deleting assignment for ".concat(c),text:"".concat(d.message||"An error has occurred.")}),r.abrupt("return",d);case 11:case"end":return r.stop()}}),r)})))()},getFileContent:function(e,t,n){return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,o,u,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.id,i=e.external,s=e.year,c=t.path,o="/services/assignments.php?action=getFileContent&course_id=".concat(a).concat(i?"&X":"","&year=").concat(s),r.next=5,fetch(o,{method:"post",headers:{Accept:"application/json"},body:JSON.stringify({path:c})});case 5:return u=r.sent,r.next=8,u.json();case 8:return l=r.sent,!l.success&&n&&n({type:"bad",group:"main",title:"Getting content of ".concat(c),text:"".concat(l.message||"An error has occurred.")}),r.abrupt("return",l);case 11:case"end":return r.stop()}}),r)})))()},createFile:function(e,t,n){return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,o,u,l,d,p,m,f;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.id,i=e.external,s=e.year,c=t.folderPath,o=t.name,u=t.show,l=t.binary,d=t.content,p="/services/assignments.php?action=getFileContent&course_id=".concat(a).concat(i?"&X":"","&year=").concat(s),r.next=5,fetch(p,{method:"post",headers:{Accept:"application/json"},body:JSON.stringify({folderPath:c,name:o,show:u,binary:l,content:d})});case 5:return m=r.sent,r.next=8,m.json();case 8:return f=r.sent,!f.success&&n&&n({type:"bad",group:"main",title:"Creating file ".concat(c+"/"+o),text:"".concat(f.message||"An error has occurred.")}),r.abrupt("return",f);case 11:case"end":return r.stop()}}),r)})))()},editFile:function(e,t,n){return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,o,u,l,d,p,m;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.id,i=e.external,s=e.year,c=t.path,o=t.content,u=t.show,l=t.binary,d="/services/assignments.php?action=editFile&course_id=".concat(a).concat(i?"&X":"","&year=").concat(s),console.log(o),r.next=6,fetch(d,{method:"post",headers:{Accept:"application/json"},body:JSON.stringify({path:c,content:o,show:u,binary:l})});case 6:return p=r.sent,r.next=9,p.json();case 9:return m=r.sent,!m.success&&n&&n({type:"bad",group:"main",title:"Editing content of ".concat(c),text:"".concat(m.message||"An error has occurred.")}),r.abrupt("return",m);case 12:case"end":return r.stop()}}),r)})))()},deleteFile:function(e,t,n){return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,o,u,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.id,i=e.external,s=e.year,c=t.path,o="/services/assignments.php?action=deleteFile&course_id=".concat(a).concat(i?"&X":"","&year=").concat(s),r.next=5,fetch(o,{method:"post",headers:{Accept:"application/json"},body:JSON.stringify({path:c})});case 5:return u=r.sent,r.next=8,u.json();case 8:return l=r.sent,!l.success&&n&&n({type:"bad",group:"main",title:"Deleting file ".concat(c),text:"".concat(l.message||"An error has occurred.")}),r.abrupt("return",l);case 11:case"end":return r.stop()}}),r)})))()}}),h=f,v={name:"FileEditor",props:{course:Object},components:{codemirror:p["codemirror"],Editor:m["Editor"]},data:function(){return{binary:!1,show:!0,fileContent:"",file:void 0,extensionRegex:/(?:\.([^.]+))?$/,editorOptions:{hideModeSwitch:!1},modes:{c:"text/x-csrc",cpp:"text/x-c++src",java:"text/x-java",json:"application/json",javascript:"text/javascript",typescript:"text/typescript"},cmOptions:{tabSize:4,mode:"text/x-csrc",theme:"idea",lineNumbers:!0,line:!0,autoCloseBrackets:!0,viewportMargin:1/0},rawEditorFileExtensions:["c","cpp","java","js","mat","php","autotest","zadaca","json","txt","autotest2"],isSaving:!1}},computed:{editable:function(){return this.file&&!this.file.isDirectory?{type:this.extensionRegex.exec(this.file.name)[1]}:{type:"none"}}},methods:{save:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isSaving=!0,n="",e.$refs.toaster?n=e.$refs.toaster.invoke("getHtml"):e.$refs.mirror&&(n=e.fileContent),t.next=5,h.editFile(e.course,{path:e.file.path,content:n,show:e.show,binary:e.binary});case 5:if(r=t.sent,e.isSaving=!1,r.success){t.next=10;break}return e.$notify({type:"bad",group:"main",title:"Save file",text:"".concat(r.message||"An error has occurred.")}),t.abrupt("return",!1);case 10:e.$notify({type:"good",group:"main",title:"Save file",text:"File /".concat(e.file.parent.parent.name,"/").concat(e.file.parent.name,"/").concat(e.file.name," saved.")});case 11:case"end":return t.stop()}}),t)})))()},refresh:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.file=e,t.$refs.toaster&&(t.$refs.toaster.invoke("height","75vh"),t.$refs.toaster.invoke("setHtml","")),t.fileContent="",console.log(e),!t.file||!t.file.parent){n.next=13;break}return n.next=7,h.getFileContent(t.course,{path:t.file.path});case 7:if(r=n.sent,r.success){n.next=10;break}return n.abrupt("return",!1);case 10:t.$refs.toaster?t.$refs.toaster.invoke("setHtml",r.data.content):t.$refs.mirror&&(t.fileContent=r.data.content),t.binary=t.file.binary,t.show=t.file.show;case 13:["autotest","zadaca","json","autotest2"].includes(t.extensionRegex.exec(e.name)[1])?t.cmOptions.mode=t.modes.json:["c"].includes(t.extensionRegex.exec(e.name)[1])?t.cmOptions.mode=t.modes.c:["cpp"].includes(t.extensionRegex.exec(e.name)[1])?t.cmOptions.mode=t.modes.cpp:["java"].includes(t.extensionRegex.exec(e.name)[1])?t.cmOptions.mode=t.modes.java:["js"].includes(t.extensionRegex.exec(e.name)[1])?t.cmOptions.mode=t.modes.javascript:["ts"].includes(t.extensionRegex.exec(e.name)[1])&&(t.cmOptions.mode=t.modes.typescript);case 14:case"end":return n.stop()}}),n)})))()}}},g=v,x=n("2877"),b=n("6544"),y=n.n(b),w=n("8336"),k=n("b0af"),j=n("99d9"),C=n("ac7c"),O=n("2fa4"),_=Object(x["a"])(g,l,d,!1,null,"3beb48fe",null),R=_.exports;y()(_,{VBtn:w["a"],VCard:k["a"],VCardTitle:j["d"],VCheckbox:C["a"],VSpacer:O["a"]});var A={components:{VueContext:u["a"],FileEditor:R},mounted:function(){},data:function(){return{loading:!1,showOverlay:!1,overlayAction:"",extensionRegex:/(?:\.([^.]+))?$/,fileTypes:{html:"mdi-language-html5",c:"mdi-language-c",cpp:"mdi-language-cpp",js:"mdi-nodejs",json:"mdi-code-json",md:"mdi-language-markdown",pdf:"mdi-file-pdf",png:"mdi-file-image",txt:"mdi-file-document-outline",autotest:"mdi-cog",autotest2:"mdi-cog",zadaca:"mdi-arrow-top-right-thick"},globalIdCounter:1,rawEditorFileExtensions:["c","cpp","java","js","mat","php","autotest","zadaca","json","txt","autotest2"],active:[],editorText:"This is initialValue.",editorOptions:{hideModeSwitch:!1},language:"x-csrc",code:"",cmOptions:{tabSize:4,mode:"text/x-csrc",theme:"idea",lineNumbers:!0,line:!0,autoCloseBrackets:!0,viewportMargin:1/0}}},computed:Object(c["a"])(Object(c["a"])({},Object(o["b"])(["courseById","assignmentsForCourse"])),{},{activeSelections:function(){return this.active},course:function(){var e=this.$route.params.course_id;return this.courseById(e)},assignments:function(){var e=this.$route.params.course_id,t=this.courseById(e),n=this.assignmentsForCourse(t);return n=void 0===n?[]:n.children,n},editorType:function(){if(0!==this.active.length){var e=this.active[0];return e.isDirectory?"none":{type:this.extensionRegex.exec(e.name)[1]}}return"none"},sidebarContent:function(e){return e}}),methods:{hideOverlay:function(){this.showOverlay=!1;var e,t=document.getElementById("overlayChildId"),n=t.childNodes,r=Object(s["a"])(n);try{for(r.s();!(e=r.n()).done;){var a=e.value;t.removeChild(a)}}catch(i){r.e(i)}finally{r.f()}},insertOverlayChild:function(e){var t=this,n=this.$refs.overlayChildRef;void 0===n?setTimeout((function(){t.insertOverlayChild(e)}),1e3):(n.$el.appendChild(e),this.loading=!1,this.showOverlay=!0)},refreshAssignments:function(){this.$store.dispatch("refreshAssignments")},assignmentEligible:function(e){var t=!0;return e.isDirectory||(t=!1),e.children&&e.children.forEach((function(e){e.isDirectory||(t=!1)})),t},fileEligible:function(e){var t=!0;return e.isDirectory||(t=!1),e.children&&e.children.forEach((function(e){e.isDirectory&&(t=!1)})),t},onClick:function(e,t){this.loading=!0,this.showOverlay=!0;var n=this.prepareInstance(e,t);console.log(n),void 0!==n&&this.insertOverlayChild(n.$el),console.log(t)},activeChanged:function(e){0!==e.length&&this.treeItemClicked(e[0])},treeItemClicked:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.isDirectory){n.next=9;break}return r=t.$route.params.course_id,a=t.courseById(r),console.log(a),n.next=6,t.$refs.fileEditor.refresh(e);case 6:console.log("FILE: "+e.name),n.next=11;break;case 9:t.editorText="",console.log("FOLDER: "+e.name);case 11:case"end":return n.stop()}}),n)})))()},findInTree:function(e,t){var n=this;if(e.id===t.id&&e.name===t.name)return{name:e.name,success:!0};if(!e.children)return!1;var r=!1;return e.children.forEach((function(a){var i=n.findInTree(a,t);!0===i.success&&(i.path||(i.path=e.path),r=i)})),r},prepareInstance:function(e,t){return"Create assignment"===e?(console.log("Pre extending"),void console.log(t)):void 0}}},E=A,S=(n("df98"),n("62ad")),D=n("a523"),$=n("132d"),F=n("5d23"),I=n("a797"),V=n("0fd9"),N=n("eb2a"),T=Object(x["a"])(E,r,a,!1,null,"0e7ae78b",null);t["default"]=T.exports;y()(T,{VCard:k["a"],VCol:S["a"],VContainer:D["a"],VIcon:$["a"],VListItemTitle:F["c"],VOverlay:I["a"],VRow:V["a"],VTreeview:N["a"]})},"7ba3":function(e,t,n){},df98:function(e,t,n){"use strict";var r=n("2745"),a=n.n(r);a.a}}]);
//# sourceMappingURL=chunk-38ff377a.a88a1bc6.js.map